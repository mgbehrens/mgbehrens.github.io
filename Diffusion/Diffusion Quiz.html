<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0f14" />
  <title>Diffusion Quiz - 20 Questions</title>
    <style>
    :root{
      --bg: #0b0f14;
      --text: #e6edf3;
      --muted: #9aa7b2;
      --card: #0f1620;
      --border: #263241;
      --shadow: rgba(0,0,0,.25);

      --btn-bg: #162232;
      --btn-bg-hover: #1b2a3e;
      --btn-border: #2a3a4f;
      --btn-text: var(--text);

      --primary: #3b82f6;
      --primary-hover: #2563eb;

      --ok-bg: rgba(34, 197, 94, 0.12);
      --ok-border: rgba(34, 197, 94, 0.35);

      --bad-bg: rgba(239, 68, 68, 0.12);
      --bad-border: rgba(239, 68, 68, 0.35);

      --focus: rgba(59, 130, 246, 0.45);
    }

    /* Optional: if user prefers light mode, respect it */
    @media (prefers-color-scheme: light){
      :root{
        --bg: #ffffff;
        --text: #111827;
        --muted: #4b5563;
        --card: #ffffff;
        --border: #d1d5db;
        --shadow: rgba(0,0,0,.08);

        --btn-bg: #f3f4f6;
        --btn-bg-hover: #e5e7eb;
        --btn-border: #d1d5db;
        --btn-text: #111827;

        --primary: #1f6feb;
        --primary-hover: #1857bd;

        --ok-bg: #e9f7ef;
        --ok-border: #bfe7cd;

        --bad-bg: #fdecea;
        --bad-border: #f5c2bd;

        --focus: rgba(31, 111, 235, 0.35);
      }
    }

    *{ box-sizing: border-box; }
    body{
      font-family: Arial, sans-serif;
      margin: 24px;
      line-height: 1.4;
      background: var(--bg);
      color: var(--text);
    }
    .wrap { max-width: 800px; margin: 0 auto; }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 6px 18px var(--shadow);
    }

    .muted{ color: var(--muted); font-size: 0.95rem; }

    .q-title{ margin: 0 0 8px; }

    .choices{ list-style: none; padding: 0; margin: 0; }
    .choices li{ margin: 10px 0; }

    label{ cursor: pointer; }
    input[type="radio"]{
      accent-color: var(--primary);
      transform: translateY(1px);
    }

    /* Focus visibility */
    button:focus, input[type="radio"]:focus{
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }

    .btnrow{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    button{
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--btn-border);
      background: var(--btn-bg);
      color: var(--btn-text);
      cursor: pointer;
    }
    button:hover{ background: var(--btn-bg-hover); }

    button.primary{
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }
    button.primary:hover{ background: var(--primary-hover); }

    .feedback{
      margin-top: 10px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }
    .ok{ background: var(--ok-bg); border-color: var(--ok-border); }
    .bad{ background: var(--bad-bg); border-color: var(--bad-border); }

    .hidden{ display: none; }

    .progress{
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .pill{
      padding: 4px 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      font-size: 0.9rem;
      background: rgba(255,255,255,.03);
    }

    .explain{ margin-top: 8px; }
  
    /* Fireworks overlay (shown only on 20/20) */
    canvas.fireworks{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 9999;
    }

  </style>
</head>

<body>

<div class="quiz-header">
  <a href="../index.html" class="index-link" aria-label="Back to Home">← Back to Home</a>
</div>

<style>
  .quiz-header {
    max-width: 1100px;
    margin: 0 auto 12px auto;
    padding: 12px 16px 0 16px;
    display: flex;
    justify-content: flex-end;
  }

  .index-link {
    text-decoration: none;
    font-weight: 600;
    color: #eaeaf0;
    padding: 6px 10px;
    border-radius: 8px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.18);
  }

  .index-link:hover {
    background: rgba(255,255,255,0.14);
  }
</style>




  <canvas id="fireworks" class="fireworks" style="display:none;"></canvas>

  <div class="wrap">
     <h1>Diffusion Quiz (20 questions)</h1>
    <p class="muted">Atomic diffusion mechanisms, driving forces, temperature effects, and Fick’s laws, and how diffusion governs processes such as case hardening, nitriding, oxidation, sintering, creep, and microstructural evolution in engineering materials.</p>

    <div class="card progress">
      <div>
        <div class="pill" id="progressText">Question 1 of 1</div>
      </div>
      <div class="pill" id="scoreText">Score: 0</div>
    </div>

    <div class="card" id="quizCard">
      <h2 class="q-title" id="questionText">Loading…</h2>
      <p class="muted" id="questionMeta"></p>

      <form id="choicesForm">
        <ul class="choices" id="choicesList"></ul>
      </form>

      <div class="btnrow">
        <button class="primary" id="checkBtn" type="button">Check answer</button>
        <button id="nextBtn" type="button" class="hidden">Next</button>
        <button id="restartBtn" type="button">Restart</button>
      </div>

      <div id="feedbackBox" class="feedback hidden"></div>
    </div>

    <div class="card hidden" id="summaryCard">
      <h2>Results</h2>
      <p id="summaryText"></p>
      <button class="primary" id="restartBtn2" type="button">Restart quiz</button>
    </div>
  </div>

  <script>
    // =========================
    // 1) QUESTION BANK (EDIT ME)
    // =========================
    // correctIndex is 0-based (0 = A, 1 = B, etc.)
const QUESTIONS = [
  {
    topic: "Definition",
    question: "What is diffusion in materials science?",
    choices: [
      "The elastic movement of atoms under load",
      "The movement of atoms due to a concentration gradient",
      "The sliding of dislocations",
      "The rotation of grains"
    ],
    correctIndex: 1,
    explanation: "Diffusion is the thermally activated movement of atoms from regions of high concentration to low concentration, driven by a concentration gradient."
  },
  {
    topic: "Driving Force",
    question: "What is the primary driving force for diffusion?",
    choices: [
      "Applied stress",
      "Temperature gradient",
      "Concentration gradient",
      "Electric current"
    ],
    correctIndex: 2,
    explanation: "Atoms diffuse to reduce chemical potential differences, which are commonly expressed as concentration gradients."
  },
  {
    topic: "Temperature",
    question: "Why does diffusion increase rapidly with temperature?",
    choices: [
      "Atoms increase in size",
      "Vacancies disappear",
      "Atoms gain thermal energy to overcome activation barriers",
      "Grain boundaries dissolve"
    ],
    correctIndex: 2,
    explanation: "Higher temperatures provide atoms with sufficient energy to overcome activation energy barriers for atomic movement."
  },
  {
    topic: "Activation Energy",
    question: "Activation energy for diffusion represents:",
    choices: [
      "Energy to break atomic nuclei",
      "Energy required for an atom to move from one site to another",
      "Energy released during diffusion",
      "Energy needed to form dislocations"
    ],
    correctIndex: 1,
    explanation: "Activation energy is the energy barrier an atom must overcome to move to a neighbouring lattice site or interstitial position."
  },
  {
    topic: "Vacancies",
    question: "Why are vacancies essential for substitutional diffusion?",
    choices: [
      "They reduce grain size",
      "They provide empty lattice sites for atoms to move into",
      "They strengthen the lattice",
      "They eliminate diffusion"
    ],
    correctIndex: 1,
    explanation: "Substitutional atoms require vacant lattice sites to move; without vacancies, substitutional diffusion cannot occur."
  },
  {
    topic: "Interstitial Diffusion",
    question: "Which atom diffuses most rapidly in iron?",
    choices: ["Nickel", "Chromium", "Carbon", "Molybdenum"],
    correctIndex: 2,
    explanation: "Carbon diffuses interstitially in iron, allowing it to move much faster than larger substitutional alloying atoms."
  },
  {
    topic: "Diffusion Mechanisms",
    question: "Which diffusion mechanism is faster at a given temperature?",
    choices: [
      "Substitutional diffusion",
      "Interstitial diffusion",
      "Dislocation climb",
      "Grain rotation"
    ],
    correctIndex: 1,
    explanation: "Interstitial diffusion is faster because small atoms move through interstitial sites without needing vacancies."
  },
  {
    topic: "Crystal Structure",
    question: "How does crystal structure influence diffusion rate?",
    choices: [
      "No influence",
      "More open structures allow faster diffusion",
      "Only affects dislocations",
      "Only affects strength"
    ],
    correctIndex: 1,
    explanation: "More open crystal structures provide easier diffusion paths, increasing diffusion rates."
  },
  {
    topic: "Grain Boundaries",
    question: "Why is diffusion faster along grain boundaries?",
    choices: [
      "Higher atomic packing",
      "Lower activation energy and higher defect density",
      "Larger grains",
      "Higher carbon content"
    ],
    correctIndex: 1,
    explanation: "Grain boundaries are high-energy regions with disordered atomic structures, allowing faster diffusion."
  },
  {
    topic: "Surface Diffusion",
    question: "Compared to bulk diffusion, surface diffusion is generally:",
    choices: [
      "Slower",
      "The same",
      "Faster",
      "Impossible"
    ],
    correctIndex: 2,
    explanation: "Atoms at surfaces are less constrained and therefore diffuse more rapidly than atoms in the bulk lattice."
  },
  {
    topic: "Fick’s First Law",
    question: "Fick’s First Law applies to:",
    choices: [
      "Non-steady-state diffusion",
      "Steady-state diffusion",
      "Dislocation motion",
      "Phase transformation"
    ],
    correctIndex: 1,
    explanation: "Fick’s First Law describes diffusion under steady-state conditions, where concentration does not change with time."
  },
  {
    topic: "Fick’s Second Law",
    question: "Fick’s Second Law describes:",
    choices: [
      "Steady diffusion only",
      "Time-dependent diffusion",
      "Elastic deformation",
      "Grain growth"
    ],
    correctIndex: 1,
    explanation: "Fick’s Second Law describes how concentration changes with time during non-steady-state diffusion."
  },
  {
    topic: "Diffusion Distance",
    question: "How does diffusion distance scale with time?",
    choices: [
      "Linearly with time",
      "Exponentially with time",
      "Proportional to the square root of time",
      "Independent of time"
    ],
    correctIndex: 2,
    explanation: "Diffusion distance is proportional to the square root of time, meaning long diffusion distances require disproportionately long times."
  },
  {
    topic: "Heat Treatment",
    question: "Why is diffusion essential in carburising?",
    choices: [
      "To melt the surface",
      "To allow carbon to migrate into the steel surface",
      "To form martensite directly",
      "To eliminate grain boundaries"
    ],
    correctIndex: 1,
    explanation: "Carburising relies on diffusion of carbon atoms into the steel surface while it is in the austenitic phase."
  },
  {
    topic: "Nitriding",
    question: "Why can nitriding occur at lower temperatures than carburising?",
    choices: [
      "Nitrogen diffuses interstitially and reacts strongly with alloying elements",
      "Nitrogen is heavier than carbon",
      "Vacancies are not required",
      "Quenching is not required"
    ],
    correctIndex: 0,
    explanation: "Nitrogen diffuses interstitially and forms stable nitrides, allowing effective case formation at lower temperatures."
  },
  {
    topic: "Diffusion vs Dislocations",
    question: "Which process is diffusion-controlled rather than dislocation-controlled?",
    choices: [
      "Plastic deformation",
      "Work hardening",
      "Creep at high temperature",
      "Elastic deformation"
    ],
    correctIndex: 2,
    explanation: "At high temperatures, creep involves diffusion-assisted mechanisms such as dislocation climb and atomic diffusion."
  },
  {
    topic: "Alloying Elements",
    question: "Why do large substitutional alloying elements diffuse slowly?",
    choices: [
      "They reduce temperature",
      "They require vacancies and have high activation energy",
      "They move interstitially",
      "They reduce grain size"
    ],
    correctIndex: 1,
    explanation: "Large atoms require vacant lattice sites and distort the lattice, increasing activation energy for diffusion."
  },
  {
    topic: "Oxidation",
    question: "Why does oxidation of metals depend on diffusion?",
    choices: [
      "Oxygen must diffuse through the oxide layer",
      "Dislocations must move",
      "Grains must grow",
      "Stress must be applied"
    ],
    correctIndex: 0,
    explanation: "Oxide growth is controlled by diffusion of ions or atoms through the oxide scale."
  },
  {
    topic: "Sintering",
    question: "Which manufacturing process relies heavily on diffusion?",
    choices: [
      "Casting",
      "Forging",
      "Sintering of powders",
      "Machining"
    ],
    correctIndex: 2,
    explanation: "Sintering uses diffusion to bond powder particles together without melting."
  },
  {
    topic: "Engineering Significance",
    question: "Why is diffusion critical in materials engineering?",
    choices: [
      "It controls colour and appearance",
      "It governs heat treatment, microstructure evolution, and service performance",
      "It only affects surface roughness",
      "It eliminates defects"
    ],
    correctIndex: 1,
    explanation: "Diffusion controls phase transformations, case hardening, creep, oxidation, and long-term material behaviour."
  }
];

    // =========================
    // 2) QUIZ ENGINE (NO NEED TO EDIT)
    // =========================
    let idx = 0;
    let score = 0;
    let answered = false; // prevent double scoring

    const progressText = document.getElementById("progressText");
    const scoreText = document.getElementById("scoreText");
    const questionText = document.getElementById("questionText");
    const questionMeta = document.getElementById("questionMeta");
    const choicesList = document.getElementById("choicesList");
    const feedbackBox = document.getElementById("feedbackBox");

    const checkBtn = document.getElementById("checkBtn");
    const nextBtn = document.getElementById("nextBtn");
    const restartBtn = document.getElementById("restartBtn");
    const restartBtn2 = document.getElementById("restartBtn2");

    const quizCard = document.getElementById("quizCard");
    const summaryCard = document.getElementById("summaryCard");
    const summaryText = document.getElementById("summaryText");

    function renderQuestion() {
      answered = false;
      feedbackBox.className = "feedback hidden";
      feedbackBox.innerHTML = "";
      nextBtn.classList.add("hidden");

      const q = QUESTIONS[idx];
      progressText.textContent = `Question ${idx + 1} of ${QUESTIONS.length}`;
      scoreText.textContent = `Score: ${score}`;
      questionText.textContent = q.question;
      questionMeta.textContent = q.topic ? `Topic: ${q.topic}` : "";

      // Build choices (radio buttons)
      choicesList.innerHTML = "";
      q.choices.forEach((choice, i) => {
        const li = document.createElement("li");
        const id = `q${idx}_c${i}`;
        li.innerHTML = `
          <label for="${id}">
            <input type="radio" name="choice" id="${id}" value="${i}" />
            ${choice}
          </label>
        `;
        choicesList.appendChild(li);
      });
    }

    function getSelectedIndex() {
      const selected = document.querySelector('input[name="choice"]:checked');
      return selected ? Number(selected.value) : null;
    }

    function lockChoices() {
      document.querySelectorAll('input[name="choice"]').forEach(el => el.disabled = true);
    }

    function unlockChoices() {
      document.querySelectorAll('input[name="choice"]').forEach(el => el.disabled = false);
    }

    function showFeedback(isCorrect, q) {
      feedbackBox.classList.remove("hidden");
      feedbackBox.classList.toggle("ok", isCorrect);
      feedbackBox.classList.toggle("bad", !isCorrect);

      const correctText = q.choices[q.correctIndex];
      feedbackBox.innerHTML = `
        <strong>${isCorrect ? "Correct!" : "Not quite."}</strong>
        <div class="explain">
          ${isCorrect ? "" : `Correct answer: <strong>${correctText}</strong><br/>`}
          ${q.explanation ? q.explanation : ""}
        </div>
      `;
    }


    // =========================
    // Fireworks (perfect score)
    // =========================
    const fwCanvas = document.getElementById("fireworks");
    const fwCtx = fwCanvas.getContext("2d");
    let fwRunning = false;
    let fwParticles = [];
    let fwAnimId = null;

    function resizeFireworks(){
      const dpr = window.devicePixelRatio || 1;
      fwCanvas.width = Math.floor(window.innerWidth * dpr);
      fwCanvas.height = Math.floor(window.innerHeight * dpr);
      fwCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    window.addEventListener("resize", () => {
      if (fwRunning) resizeFireworks();
    });

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function spawnBurst(x, y){
      const count = Math.floor(rand(60, 120));
      for (let i = 0; i < count; i++){
        const angle = rand(0, Math.PI * 2);
        const speed = rand(1.5, 6.0);
        fwParticles.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: rand(40, 90),
          maxLife: 0, // set below
          size: rand(1.2, 2.6),
          hue: rand(0, 360)
        });
      }
      // assign maxLife after creation so we can fade nicely
      for (let p of fwParticles){
        if (p.maxLife === 0) p.maxLife = p.life;
      }
    }

    function tickFireworks(){
      fwCtx.clearRect(0, 0, window.innerWidth, window.innerHeight);

      // Occasionally spawn a new burst
      if (Math.random() < 0.08){
        spawnBurst(rand(window.innerWidth * 0.15, window.innerWidth * 0.85),
                  rand(window.innerHeight * 0.15, window.innerHeight * 0.55));
      }

      const gravity = 0.06;
      const drag = 0.985;

      fwParticles = fwParticles.filter(p => p.life > 0);
      for (let p of fwParticles){
        p.life -= 1;
        p.vx *= drag;
        p.vy = p.vy * drag + gravity;

        p.x += p.vx;
        p.y += p.vy;

        const t = p.life / p.maxLife; // 1..0
        const alpha = Math.max(0, Math.min(1, t));

        fwCtx.beginPath();
        fwCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        fwCtx.fillStyle = `hsla(${p.hue}, 100%, 60%, ${alpha})`;
        fwCtx.fill();
      }

      fwAnimId = requestAnimationFrame(tickFireworks);
    }

    function startFireworks(){
      if (fwRunning) return;
      fwRunning = true;
      fwParticles = [];
      fwCanvas.style.display = "block";
      resizeFireworks();

      // Kick off with a few bursts
      for (let i = 0; i < 4; i++){
        spawnBurst(rand(window.innerWidth * 0.2, window.innerWidth * 0.8),
                  rand(window.innerHeight * 0.2, window.innerHeight * 0.55));
      }

      tickFireworks();

      // Stop after ~6 seconds (keeps it fun, not annoying)
      setTimeout(stopFireworks, 6000);
    }

    function stopFireworks(){
      if (!fwRunning) return;
      fwRunning = false;
      if (fwAnimId) cancelAnimationFrame(fwAnimId);
      fwAnimId = null;
      fwParticles = [];
      fwCtx.clearRect(0, 0, window.innerWidth, window.innerHeight);
      fwCanvas.style.display = "none";
    }


    function finishQuiz() {
      quizCard.classList.add("hidden");
      summaryCard.classList.remove("hidden");
      summaryText.textContent = `You scored ${score} out of ${QUESTIONS.length}.`;
      if (score === QUESTIONS.length) startFireworks();
    }

    function restartQuiz() {
      idx = 0;
      score = 0;
      answered = false;
      summaryCard.classList.add("hidden");
      quizCard.classList.remove("hidden");
      unlockChoices();
      renderQuestion();
    }

    checkBtn.addEventListener("click", () => {
      if (answered) return;

      const selectedIndex = getSelectedIndex();
      if (selectedIndex === null) {
        feedbackBox.className = "feedback bad";
        feedbackBox.textContent = "Please select an answer before checking.";
        return;
      }

      const q = QUESTIONS[idx];
      const isCorrect = selectedIndex === q.correctIndex;

      if (isCorrect) score += 1;
      answered = true;

      lockChoices();
      showFeedback(isCorrect, q);
      scoreText.textContent = `Score: ${score}`;
      nextBtn.classList.remove("hidden");
    });

    nextBtn.addEventListener("click", () => {
      idx += 1;
      if (idx >= QUESTIONS.length) {
        finishQuiz();
      } else {
        unlockChoices();
        renderQuestion();
      }
    });

    restartBtn.addEventListener("click", restartQuiz);
    restartBtn2.addEventListener("click", restartQuiz);

    // Start
    renderQuestion();
  </script>
</body>
</html>
